## Определение звеньев для управления видимости и закрытости

В этом разделе мы поговорим о звеньях и других частях системы звеньев, а именно: *путях* (paths), которые позволяют именовать элементы; ключевом слове `use`, которое приносит путь в область видимости; ключевом слове `pub`, которое делает элементы общедоступными. Мы также обсудим ключевое слово `as`, внешние дополнения и приказчик glob. А пока давайте сосредоточимся на звеньях!

Во-первых, мы начнём со списка правил, чтобы вам было легче понять при согласования рукописи в будущем. Затем мы подробно объясним каждое из правил.

### Шпаргалка по звенам

Здесь мы даём краткий обзор того, как звенья, пути, ключевое слово `use` и ключевое слово `pub` работают в сборщике и как большинство разработчиков согласуют свой рукопись. В этой главе мы рассмотрим примеры каждого из этих правил, и это удобный мгновение чтобы напомнить о том, как работают звенья.

- **Начнём с корня ящика**: при сборки сборщик сначала ищет корневой звено ящика (обычно это *src/lib.rs* для библиотечного ящика или *src/main.rs* для двоичного ящика) для сборки рукописи.
- **Объявление звеньев**: В файле корневого звена ящика вы можете объявить новые звенья; скажем, вы объявляете звено “garden” с помощью `mod garden;`. Сборщик будет искать рукопись звена в следующих местах:
    - в этом же файле, между фигурных скобок, которые заменяют точку с запятой после `mod garden`
    - в файле *src/garden.rs*
    - в файле *src/garden/mod.rs*
- **Объявление подзвеньев**: В любом файле, кроме корневого звена ящика, вы можете объявить подзвенья. К примеру, вы можете объявить  `mod vegetables;` в *src/garden.rs*. Сборщик будет искать рукопись подзвена в папке с именем родительского звена в следующих местах:
    - в этом же файле, сразу после `mod vegetables`, между фигурных скобок, которые заменяют точку с запятой
    - в файле *src/garden/vegetables.rs*
    - в файле *src/garden/vegetables/mod.rs*
- **Пути к рукописи в звеньях**: После того, как звено станет частью вашего ящика и если допускают правила закрытости, вы можете ссылаться на рукопись в этом звене из любого места вашего ящика, используя путь к рукописи. Например, вид `Asparagus`, в подзвене vegetables звена garden, будет найден по пути `crate::garden::vegetables::Asparagus`.
- **Скрытие или общедоступность**: Рукопись в звене по умолчанию скрыт от родительского звена. Чтобы сделать звено общедоступным, объявите его как `pub mod` вместо `mod`. Чтобы сделать элементы общедоступного звена тоже общедоступными, используйте `pub` перед их объявлением.
- **Ключевое слово `use`**: Внутри области видимости использование ключевого слова `use` создаёт псевдонимы для элементов, чтобы уменьшить повторение длинных путей. В любой области видимости, в которой может обращаться к `crate::garden::vegetables::Asparagus`, вы можете создать псевдоним `use crate::garden::vegetables::Asparagus;` и после этого вам нужно просто писать `Asparagus`, чтобы использовать этот вид в этой области видимости.

Мы создали двоичный ящик `backyard`, который отображает эти правила. Директория ящика, также названная как `backyard`, содержит следующие файлы и папки:

```text
backyard
├── Cargo.lock
├── Cargo.toml
└── src
    ├── garden
    │   └── vegetables.rs
    ├── garden.rs
    └── main.rs
```

Файл корневого звена ящика в нашем случае  *src/main.rs*, и его содержимое:

<span class="filename">Файл: src/main.rs</span>

```rust,noplayground,ignore
{{#rustdoc_include ../listings/ch07-managing-growing-projects/quick-reference-example/src/main.rs}}
```

Строка `pub mod garden;` говорит сборщику о подключении рукописи, найденном в *src/garden.rs*:

<span class="filename">Файл: src/garden.rs</span>

```rust,noplayground,ignore
{{#rustdoc_include ../listings/ch07-managing-growing-projects/quick-reference-example/src/garden.rs}}
```

А здесь `pub mod vegetables;` указывает на подключаемый рукопись в *src/garden/vegetables.rs*. Эту рукопись:

```rust,noplayground,ignore
{{#rustdoc_include ../listings/ch07-managing-growing-projects/quick-reference-example/src/garden/vegetables.rs}}
```

Теперь давайте рассмотрим подробности этих правил и отобразим их в действии!

### Объединение связанного рукописи в звеньях

*Звенья* позволяют упорядочивать рукопись внутри ящика для удобочитаемости и лёгкого повторного использования. Звенья также позволяют нам управлять *закрытостью* элементов, поскольку рукопись внутри звена по умолчанию является закрытым. Частные элементы — это внутренние подробности выполнения, недоступные для внешнего использования. Мы можем сделать звенья и элементы внутри них общедоступными, что позволит внешнему рукописи использовать их и зависеть от них.

В качестве примера, давайте напишем библиотечный ящик предоставляющий возможность ресторана. Мы определим ярлыки функций, но оставим их тела пустыми, чтобы сосредоточиться на согласования рукописи, вместо выполнения рукописи для ресторана.

В ресторанной индустрии некоторые части ресторана называются *фронтом дома*, а другие *задней частью дома*. Фронт дома это там где находятся конечные потребители; здесь размещаются места конечных потребителей, официанты принимают заказы и оплаты, а бармены делают напитки. Задняя часть дома это где шеф-повара и повара работают на кухне,  работают посудомоечные машины, а управленцы занимаются управленческой деятельностью.

Чтобы внутренне выстроить ящик подобно тому, как работает настоящий ресторан, можно согласовать размещение функций во вложенных звеньях. Создадим новую библиотеку (библиотечный ящик) с именем `restaurant` выполнив приказ `cargo new restaurant --lib`; затем вставим рукопись из приложения 7-1 в *src/lib.rs* для определения некоторых звеньев и ярлыков функций. Это раздел фронта дома:

<span class="filename">Файл: src/lib.rs</span>

```rust,noplayground
{{#rustdoc_include ../listings/ch07-managing-growing-projects/listing-07-01/src/lib.rs}}
```

<span class="caption">Приложение 7-1: Звено <code>front_of_house</code> , содержащий другие звенья, которые в свою очередь содержат функции</span>

Мы определяем звено, начиная с ключевого слова  `mod`, затем определяем название звена (в данном случае `front_of_house`) и размещаем фигурные скобки вокруг тела звена. Внутри звеньев, можно иметь другие звенья, как в случае с звенами `hosting` и `serving`. Звенья также могут содержать определения для других элементов, таких как устройства, перечисления, постоянные переменные, особенности или — как в приложении 7-1 — функции.

Используя звенья, мы можем объединять связанные определения вместе и сказать почему они являются связанными. Программистам будет легче найти необходимую возможность в объединенном рукописи, вместо того чтобы искать её в одном общем списке. Программисты, добавляющие новые функции в эту рукопись, будут знать, где разместить рукопись для поддержания порядка в программе.

Как мы упоминали ранее, файлы *src/main.rs* и *src/lib.rs* называются *корневыми звенами ящика*. Причина такого именования в том, что содержимое любого из этих двух файлов образует звено с именем `crate` в корне устройства звеньев ящика, известной как *дерево звеньев*.

В приложении 7-2 показано дерево звеньев для устройства звеньев, приведённой в рукописи приложения 7-1.

```text
crate
 └── front_of_house
     ├── hosting
     │   ├── add_to_waitlist
     │   └── seat_at_table
     └── serving
         ├── take_order
         ├── serve_order
         └── take_payment
```

<span class="caption">Приложение 7-2: Древо звеньев для программы из Приложения 7-1</span>

Это дерево показывает, как некоторые из звеньев вкладываются друг в друга; например, `hosting` находится внутри `front_of_house`. Дерево также показывает, что некоторые звенья являются  *братьями* (siblings) друг для друга, то есть они определены в одном звене; `hosting` и `serving` это братья которые определены внутри `front_of_house`. Если звено A содержится внутри звена B, мы говорим, что звено A является *потомком* (child) звена B, а звено B является *родителем* (parent) звена A. Обратите внимание, что родителем всего дерева звеньев является неявное звено с именем `crate`.

Дерево звеньев может напомнить вам дерево папок файловой системы на компьютере; это очень удачное сравнение! По подобию с папкими в файловой системе, мы используется звенья для согласования рукописи. И так же, как нам надо искать файлы в папких на компьютере, нам требуется способ поиска нужных звеньев.
